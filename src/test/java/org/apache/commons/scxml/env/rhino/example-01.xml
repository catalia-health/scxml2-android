<?xml version="1.0"?>
<!--
  * Licensed to the Apache Software Foundation (ASF) under one or more
  * contributor license agreements.  See the NOTICE file distributed with
  * this work for additional information regarding copyright ownership.
  * The ASF licenses this file to You under the Apache License, Version 2.0
  * (the "License"); you may not use this file except in compliance with
  * the License.  You may obtain a copy of the License at
  *
  *     http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
-->
<!-- SCXML Rhino (ECMA / E4X) environment: example script -->
<scxml xmlns="http://www.w3.org/2005/07/scxml" version="1.0" initial="main">

    <!-- Root or document datamodel -->
    <datamodel>
        <data id="docdata">
            <root xmlns="">
                <foo>foo</foo>
            </root>
        </data>
    </datamodel>

    <state id="main">
        <initial>
            <transition target="ten" />
        </initial>

        <!-- datamodel scoped to state "main" -->
        <datamodel>
            <data id="mainvar" expr="0" />
            <data id="maindata">
                <root xmlns="">
                    <foo>
                        <bar>bar</bar>
                    </foo>
                </root>
            </data>
        </datamodel>

        <state id="ten">
            <onentry>
                <assign name="mainvar" expr="10" />
            </onentry>
            <transition event="ten.done" cond="mainvar == 10 &amp;&amp; maindata.root.foo.bar == 'bar'" target="twenty" />
            <onexit>
                <script>maindata.root.foo.bar.* = 'baz';</script>
            </onexit>
        </state>
        <state id="twenty">
            <onentry>
                <assign name="mainvar" expr="20" />
            </onentry>
            <transition event="twenty.done" cond="mainvar == 20 &amp;&amp; maindata.root.foo.bar == 'baz'" target="thirty" />
            <onexit>
                <script> docdata.root.foo.* = maindata.root.foo; docdata.root.foo.bar.* = 10; </script>
                <log label="datamodel01" expr="docdata.toString()" />
            </onexit>
        </state>
        <state id="thirty">
            <transition event="thirty.done" cond="docdata.root.foo.bar &gt; 5" target="forty" />
        </state>
        <state id="forty" final="true" />

    </state>

</scxml>

